"use strict";exports.id=289,exports.ids=[289],exports.modules={99289:(e,s,t)=>{t.d(s,{Z:()=>p});var a=t(93807),l=t(72810),r=t(14014);let i=()=>(0,a.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg border border-blue-100",children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Tips"}),(0,a.jsxs)("ul",{className:"space-y-2 text-blue-700",children:[(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDC46"}),a.jsx("span",{children:"Click any word in the article to look it up"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDD0D"}),a.jsx("span",{children:"Use the search box above to look up any word"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"\uD83C\uDF1F"}),a.jsx("span",{children:"Clicked words are automatically saved to your word list"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDD0A"}),a.jsx("span",{children:"Click the speaker icon to hear pronunciation"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"\uD83C\uDF10"}),a.jsx("span",{children:"Click the globe icon to translate paragraphs"})]})]})]});var n=t(49278),o=t(63670),d=t(91060);function c(e){return e.replace(/[.,/#?!$%^&*;:{}=\-_`~()"']/g,"").toLowerCase().trim()}var h=t(66267);function x({text:e,id:s,isMarkdown:t,onWordClick:r}){let[i,x]=(0,l.useState)(""),[m,u]=(0,l.useState)(null),{speak:p,speaking:g}=(0,n.I)(),{translating:j,translate:b}=(0,o.$)(),{words:f,addWord:w,removeWord:v}=(0,d.K)(),y=async()=>{i||x(await b(e))},N=async()=>{u(s),await p(e),u(null)},k=e=>{console.log("Clicked word:",e);let s=c(e);f.has(s)?v(s):w(s),r(s)};return(0,a.jsxs)("div",{className:"group relative bg-white pr-8 sm:pr-12 shadow1-sm hover:shadow1-md transition1-shadow",children:[a.jsx("div",{className:"text-slate-800 leading-relaxed prose prose-sm max-w-none",children:t?a.jsx(h.D,{children:e}):a.jsx(a.Fragment,{children:(e=>{let s=e.split(/(\s+)/);return a.jsx(a.Fragment,{children:s.map((e,s)=>{let t=c(e);return t?a.jsx("span",{onClick:()=>k(e),className:`cursor-pointer ${f.has(t)?"bg-yellow-100 hover:bg-yellow-200":"hover:bg-gray-100"} transition-colors duration-200`,children:e},s):e})})})(e)})}),i&&a.jsx("div",{className:"mt-2 text-slate-600 bg-slate-50 p-2 rounded prose prose-sm max-w-none",children:t?a.jsx(h.D,{children:i}):i}),(0,a.jsxs)("div",{className:"absolute right-0 top-0 flex flex-col",children:[a.jsx("button",{onClick:N,className:"w-9 h-9 flex items-center justify-center bg-white hover:bg-gray-50 text-gray-600 hover:text-gray-800 rounded-full shadow-sm transition-all duration-200",title:"Text to Speech",children:a.jsx("span",{className:g&&m===s?"inline-block animate-spin-slow":"",children:g&&m===s?"⏳":"\uD83D\uDD0A"})}),a.jsx("button",{onClick:y,className:"w-9 h-9 flex items-center justify-center bg-white hover:bg-gray-50 text-gray-600 hover:text-gray-800 rounded-full shadow-sm transition-all duration-200",title:"Translate",children:a.jsx("span",{className:j?"inline-block animate-spin-slow":"",children:j?"⏳":"\uD83C\uDF10"})})]})]})}function m({article:e,onError:s,onWordClick:t}){let[r,i]=(0,l.useState)([]),[o,d]=(0,l.useState)(""),[c,h]=(0,l.useState)(!1),m=(0,l.useRef)(null),[u,p]=(0,l.useState)(""),[g,j]=(0,l.useState)(null),{speak:b,speaking:f}=(0,n.I)(),[w,v]=(0,l.useState)(null),y=async e=>{if(e.preventDefault(),!o.trim()||c)return;let t={role:"user",content:o.trim(),timestamp:Date.now()};i(e=>[...e,t]),d(""),h(!0);let a=process.env.NEXT_PUBLIC_AI_CHAT_URL||"http://127.0.0.1:5000/ai/chat";if(!a)throw Error("Chat URL is not defined");try{let e=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:g,messages:[...r,t],type:"chat"})});if(!e.ok)throw Error("Failed to get AI response");let s=await e.json();i(e=>[...e,{role:"assistant",content:s.message,timestamp:Date.now()}])}catch(e){s?.(e)}finally{h(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col h-[calc(100vh-theme(space.20))] border rounded-lg shadow-lg bg-white",children:[a.jsx("div",{className:"p-4 border-b bg-gray-50",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Discussion"})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.map(e=>a.jsx("div",{className:`flex items-start gap-2 ${"user"===e.role?"justify-end":"justify-start"}`,children:a.jsx("div",{className:"max-w-[80%]",children:a.jsx("div",{className:`
                                    relative px-4 py-2
                                    ${"user"===e.role?"bg-gradient-to-r from-emerald-500 to-green-600 text-white rounded-t-2xl rounded-l-2xl":"bg-white border border-gray-200 shadow-sm rounded-t-2xl rounded-r-2xl"}
                                `,children:"assistant"===e.role?a.jsx(x,{text:e.content,isMarkdown:!0,id:`msg-${e.timestamp}`,onWordClick:t}):a.jsx("div",{className:"text-white",children:e.content})})})},e.timestamp)),c&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"max-w-[80%]",children:a.jsx("div",{className:"bg-white border border-gray-200 rounded-t-2xl rounded-r-2xl p-3",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"})]})})})}),a.jsx("div",{ref:m})]}),a.jsx("form",{onSubmit:y,className:"p-4 border-t mt-auto",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:"Type your response...",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[80px] resize-y",disabled:c,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y(e))}}),a.jsx("button",{type:"submit",disabled:c||!o.trim(),className:"px-4 py-2 h-fit bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})})]})}t(30983);let u=`
  @keyframes spin-slow {from {transform: rotate(0deg);}to {transform: rotate(360deg);}}
  .animate-spin-slow {animation: spin-slow 2s linear infinite;}`,p=({article:e})=>{let[s,t]=(0,l.useState)({}),[h,p]=(0,l.useState)(null),[g,j]=(0,l.useState)(null),{speak:b,speaking:f}=(0,n.I)(),[w,v]=(0,l.useState)(null),{translating:y,translate:N}=(0,o.$)(),{words:k,addWord:D,removeWord:C}=(0,d.K)(),[S,F]=(0,l.useState)(!1),[T,$]=(0,l.useState)(!1),M=e=>{console.log("Clicked word:",e);let s=c(e);p(s),k.has(s)?C(s):D(s),p(e)};return(0,a.jsxs)(a.Fragment,{children:[a.jsx("style",{children:u}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-1 relative min-h-screen w-full",children:[(0,a.jsxs)("div",{className:"flex-1 p-0 sm:p-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-center mb-6 px-2",children:a.jsx(x,{text:e.title,isMarkdown:!1,id:"title",onWordClick:M})}),S?a.jsx("div",{className:"flex-1",children:a.jsx(m,{article:e,onWordClick:M,onError:e=>console.error("Chat error:",e)})}):a.jsx("div",{className:"space-y-4 p-2",children:Object.entries(e.paragraphs||{}).map(([e,s])=>a.jsx("div",{className:"group relative p-2 bg-white p-1 hover:shadow-md transition-shadow",children:"text"===s.type?a.jsx(x,{text:s.content,isMarkdown:!1,id:e,onWordClick:M}):"image"===s.type?(0,a.jsxs)("figure",{className:"text-center",children:[a.jsx("img",{src:s.content,alt:s.description||"",className:"w-full h-auto rounded-lg",loading:"lazy"}),s.description&&a.jsx("figcaption",{className:"mt-2 text-sm text-gray-600 italic",children:s.description})]}):null},e))})]}),(0,a.jsxs)("div",{className:`fixed md:sticky bottom-0 md:top-0 left-0 right-0 md:w-2/5 lg:w-1/3 h-[200px] md:h-screen bg-white md:bg-slate-50 overflow-y-auto border-t border-slate-200 md:border-l md:border-t-0 shadow-lg md:shadow-none z-50 ${h?"":"hidden md:block"}`,children:[a.jsx(r.Z,{selectedWord:h}),!h&&a.jsx("div",{className:"m-2",children:a.jsx(i,{})})]})]}),a.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:(0,a.jsxs)("button",{onClick:()=>{F(!S)},className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center space-x-2",children:[a.jsx("span",{children:S?"Back to Article":"Practice English"}),a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})]})})]})}}};